# CVE-2025-61557

#### Affected product

nixseparatedebuginfod

#### Affected versions

nixseparatedebuginfod < 0.4.1

versions 0.4.1 and later are unaffected.

#### Description

A client can request a source file with a path outside the nix store. For example, for an existing store path `/nix/store/12345hash-foo`, a client can request the source of `/nix/store/12345hash-foo/../../../etc/resolv.conf` to obtain the content of `/etc/resolv.conf` if nixseparatedebuginfod can read it. By this flaw, nixseparatedebuginfod can effectively disclose the content of any file it can read on the system.

#### Type of vulnerability

Path traversal

#### Impact

The impact of this vulnerability depends on the way nixseparatedebuginfod is deployed. Impact for the most common deployment model (the NixOS module) is limited, but other usage scenarios are more severely affected.

* For users of the NixOS module, be it the one in the upstream repository or the one shipped as part of NixOS: nixseparatedebuginfod runs as a dedicated unix user. As a result, only world-readable files can be disclosed. As nixseparatedebuginfod only listens on localhost, the vulnerability should only matter for applications which are sandboxed to not have access to some otherwise world-readable files but still have network access to localhost.

* For users running nixseparatedebuginfod by hand as their personal unix account on localhost, this allows services running as a different (system) account to read personal files owned by the personal unix account.

* For users running nixseparatedebuginfod in a way which is accessible from the internet, anybody can remotely read any file nixseparatedebuginfod can read.

#### Additional notes

Please note that, by design, nixseparatedebuginfod will serve any file in your nix store, even on versions where this vulnerability is fixed. The nix security model assumes that the nix store cannot contain secrets.
